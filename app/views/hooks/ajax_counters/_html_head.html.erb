<%= javascript_include_tag 'ajax_counters.js', :plugin => :ajax_counters %>
<%= stylesheet_link_tag 'ajax_counters.css', :plugin => :ajax_counters %>

<%
  counters_info = {}
  # Rails.logger.debug "\v\v session = #{session.inspect}"
  # session.clear
  session.each do |k,v|
    if v.is_a?(Hash) && v.has_key?(:count) && v.has_key?(:time) && v.has_key?(:period)
      counters_info[k] = { counter: v[:count], expired: ((v[:time]+v[:period].seconds < Time.now) ? true : false), last_refresh: v[:time]}
    end
  end

%>
<script type="text/javascript">
  var ajax_stored_counters = <%= counters_info.to_json.html_safe %>;
  var refresh_counters_label = '<%= l(:label_refresh_ajax_counters) %>';
</script>
